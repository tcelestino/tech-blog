<!doctype html>
<html amp lang='pt-br'>
<head>
	<meta charset='utf-8'>
	<script async src='https://cdn.ampproject.org/v0.js'></script>
	<script async custom-element='amp-sidebar' src='https://cdn.ampproject.org/v0/amp-sidebar-0.1.js'></script>
	<script async custom-element='amp-image-lightbox' src='https://cdn.ampproject.org/v0/amp-image-lightbox-0.1.js'></script>
	<script async custom-element='amp-analytics' src='https://cdn.ampproject.org/v0/amp-analytics-0.1.js'></script>
	<title>Elo7 Tech - Novidades do JUnit 5 - parte 1</title>
	<meta name='description' content='Recentemente (setembro/2017), foi lançado o JUnit 5, a nova versão do principal framework para testes de código na plataforma Java. Neste post, vamos conhecer algumas novidades e mudanças desse novo release.'>
	<link rel='canonical' href='https://engenharia.elo7.com.br/novidades-do-junit-5-parte-1/' />
	<meta name='viewport' content='width=device-width,minimum-scale=1,initial-scale=1'>
	<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
	<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
	<style amp-custom>
		body {
			background-color: white;
			font-family: 'Open Sans', sans-serif;
			color: #666;
		}

		h1 {
			color: #333;
			font-size: 1.5em;
			margin-bottom: 0;
		}

		h2, h3 {
			color: #444;
			font-size: 1.2em;
		}

		h3 {
			font-weight: 300;
		}

		a {
			text-decoration: none;
		}

		p, li {
			font-size: 0.9em;
		}

		ul {
			padding-left: 1.5em;
		}

		article {
			line-height: 1.8;
			text-align: justify;
		}

		blockquote {
			margin: 1em;
		}

		table {
			border-collapse: collapse;
			border-spacing: 0;
			font-size: 0.9em;
			width: 100%;
			text-align: left;
		}

		table thead th {
			background-color: #4a4a4a;
			color: white;
		}

		table th, table td {
			padding: 0.2em 0.5em;
		}

		tr:nth-child(even) td {
			background-color: #f3f3f3;
		}

		table th:not(:first-child), table td:not(:first-child) {
			text-align: right;
		}

		body > header {
			height: 60px;
			box-sizing: border-box;
			background-color: #FDC24F;
			text-align: center;
			padding-top: 0.8em;
			padding-bottom: 0.8em;
			position: sticky;
			top: 0;
			z-index: 10;
		}

		body > header a {
			background: url('//images.elo7.com.br/assets/v3/desktop/svg/logo-elo7.svg') no-repeat;
			background-size: 90px 35px;
			width: 90px;
			height: 35px;
			display: inline-block;
			filter: brightness(100);
		}

		.post-content, footer {
			padding-left: 5%;
			padding-right: 5%;
		}

		.post-content .content a, .post-content .content a:visited, .post-content .content a:hover {
			cursor: pointer;
			color: #000;
			font-weight: 500;
			text-decoration: underline;
			word-break: break-word;
		}

		.post-content .post-image {
			text-align: center;
			display: block;
		}

		.post-content p:last-of-type {
			margin-bottom: 0;
		}

		main {
			background-color: #ecebeb;
			padding-top: 1em;
			padding-bottom: 1em;
		}

		.post-card, .post-content, .publisher-info {
			background: white;
			margin-left: 2%;
			padding: 1em;
			margin-right: 3%;
			box-shadow: rgba(72, 72, 72, 0.23) 0 0 5px;
		}

		.publisher-info {
			margin-bottom: 1em;
		}

		.publisher-info h1 {
			margin-top: 0;
			margin-bottom: 0.5em;
		}

		.card-devops {
			border-left: 5px solid #7d7873;
		}

		.card-eventos {
			border-left: 5px solid #fdb933;
		}

		.card-front-end {
			border-left: 5px solid #c15eb4;
		}

		.card-back-end {
			border-left: 5px solid #359c9c;
		}

		.card-mobile {
			border-left: 5px solid #fa9c5e;
		}

		.card-vagas {
			border-left: 5px solid #99c799;
		}

		.card-design {
			border-left: 5px solid #7c9ec4;
		}

		.card-cultura {
			border-left: 5px solid #f44336;
		}

		.post-card:not(:last-of-type) {
			margin-bottom: 1em;
		}

		.post-card .title {
			margin-top: 0;
			margin-bottom: 0.5em;
			text-align: left;
		}

		.post-card .title a {
			color: inherit;
		}

		.author, .date {
			color: #888;
			margin-bottom: 0;
			margin-top: 0;
			font-size: 0.9em;
		}

		.author a {
			color: inherit;
			margin-bottom: 1.5em;
		}

		#sidebar {
			width: 60vw;
			background-color: #4a4a4a;
			color: #fff;
			padding-right: 1em;
			padding-left: 1em;
		}

		#sidebar li {
			margin-bottom: 0.5em;
		}

		#sidebar ul {
			margin-bottom: 1.5em;
			list-style: none;
			padding: 0;
		}

		#sidebar h2 {
			margin-bottom: 0;
		}

		#sidebar a {
			text-decoration: none;
			font-weight: 500;
		}

		#sidebar a, #sidebar h2 {
			color: inherit;
		}

		.sidebar-trigger {
			position: absolute;
			left: 5%;
			background-color: transparent;
			border: none;
			color: #fff;
			font-size: 1.8em;
			padding: 0;
		}

		.category {
			background-color: #73bebe;
			color: #ffffff;
			text-decoration: none;
			font-size: 0.8em;
			padding: .5em;
			border-radius: 3px;
			display: inline-block;
			margin-top: 2.3em;
			cursor: pointer;
			transition: background-color 0.3s;
			font-weight: 300;
		}

		.category:hover {
			background-color: #73bebe;
		}

		.post-link {
			border: 1px solid #fba702;
			border-radius: 3px;
			color: #fba702;
			display: inline-block;
			float: right;
			margin-top: 1em;
			padding: 0.8em;
			text-align: center;
			text-decoration: none;
			transition: background-color 0.3s, color 0.3s;
			font-size: 0.9em;
		}

		.post-link:hover {
			background-color: #fba702;
			color: #ffffff;
		}

		.social {
			content: '';
			width: 25px;
			height: 25px;
			display: inline-block;
			background-position: center;
			text-indent: -9999px;
			margin-right: 0.5em;
			background-size: contain;
			vertical-align: top;
		}

		.social.twitter {
			background-image: url('/images/ico/ic-twitter.svg');
		}

		.social.linkedin {
			background-image: url('/images/ico/ic-linkedin.svg');
		}

		.social.github {
			background-image: url('/images/ico/ic-github.svg');
		}

		footer {
			background-color: #4a4a4a;
			padding-top: 0.5em;
			padding-bottom: 0.5em;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		footer a {
			color: #fff;
			text-decoration: none;
			font-size: 0.8em;
		}

		.footer-social {
			line-height: 0;
		}

		.footer-social a {
			background-size: 2em 2em;
			background-repeat: no-repeat;
			display: inline-block;
			height: 2em;
			width: 2em;
			overflow: hidden;
			text-indent: -9999px;
		}

		.footer-social a + a {
			margin-left: 0.5em;
		}

		.footer-social .github {
			background-image: url('/images/github_icon.svg');
		}
		.footer-social .email {
			background-image: url('/images/email_icon.png');
		}

		.footer-social .rss {
			background-image: url('/images/ico/feed.svg');
		}

		.footer-social .twitter {
            background-image: url('/images/ico/ic-negative-twitter.svg');
        }

		.share {
			position: relative;
			text-align: right;
			margin-top: 1em;
		}

		.share .link-share {
				display: inline-block;
				width: 30px;
				height: 30px;
				text-indent: -9999px;
				margin-left: 0.5em;
				text-align: left;
		}

		.share .link-share.facebook {
			background-image: url('/images/ico/ic-facebook.svg');
		}

		.share .link-share.twitter {
			background-image: url('/images/ico/ic-twitter.svg');
		}

		.link-input {
			opacity: 0;
			position: absolute;
			left: -9999px;
		}

		.copy-success {
			font-size: 0.75em;
			opacity: 0;
			position: absolute;
			right: 0;
			top: 125%;
			transition: opacity ease-in-out 250ms;
			text-align: center;
		}

		.copy-success.active {
			opacity: 1;
		}

		code {
			background-color: #ececec;
			padding: 0.1em 0.2em;
		}

		.hide {
			display: none;
		}

		.highlight code {
			overflow: auto;
		}

		.hljs {
			display: block;
			padding: 0.5em 1em;
			background: #23241f;
		}

		.hljs,
		.hljs-tag,
		.css .hljs-rules,
		.css .hljs-value,
		.css .hljs-function
		.hljs-preprocessor,
		.hljs-pragma {
			color: #f8f8f2;
		}

		.hljs-strongemphasis,
		.hljs-strong,
		.hljs-emphasis {
			color: #a8a8a2;
		}

		.hljs-bullet,
		.hljs-blockquote,
		.hljs-horizontal_rule,
		.hljs-number,
		.hljs-regexp,
		.alias .hljs-keyword,
		.hljs-literal,
		.hljs-hexcolor {
			color: #ae81ff;
		}

		.hljs-tag .hljs-value,
		.hljs-code,
		.hljs-title,
		.css .hljs-class,
		.hljs-class .hljs-title:last-child {
			color: #a6e22e;
		}

		.hljs-link_url {
			font-size: 80%;
		}

		.hljs-strong,
		.hljs-strongemphasis {
			font-weight: bold;
		}

		.hljs-emphasis,
		.hljs-strongemphasis,
		.hljs-class .hljs-title:last-child {
			font-style: italic;
		}

		.hljs-keyword,
		.hljs-function,
		.hljs-change,
		.hljs-winutils,
		.hljs-flow,
		.lisp .hljs-title,
		.clojure .hljs-built_in,
		.nginx .hljs-title,
		.tex .hljs-special,
		.hljs-header,
		.hljs-attribute,
		.hljs-symbol,
		.hljs-symbol .hljs-string,
		.hljs-tag .hljs-title,
		.hljs-value,
		.alias .hljs-keyword:first-child,
		.css .hljs-tag,
		.css .unit,
		.css .hljs-important {
			color: #F92672;
		}

		.hljs-function .hljs-keyword,
		.hljs-class .hljs-keyword:first-child,
		.hljs-constant,
		.css .hljs-attribute {
			color: #66d9ef;
		}

		.hljs-variable,
		.hljs-params,
		.hljs-class .hljs-title {
			color: #f8f8f2;
		}

		.hljs-string,
		.css .hljs-id,
		.hljs-subst,
		.haskell .hljs-type,
		.ruby .hljs-class .hljs-parent,
		.hljs-built_in,
		.sql .hljs-aggregate,
		.django .hljs-template_tag,
		.django .hljs-variable,
		.smalltalk .hljs-class,
		.django .hljs-filter .hljs-argument,
		.smalltalk .hljs-localvars,
		.smalltalk .hljs-array,
		.hljs-attr_selector,
		.hljs-pseudo,
		.hljs-addition,
		.hljs-stream,
		.hljs-envvar,
		.apache .hljs-tag,
		.apache .hljs-cbracket,
		.tex .hljs-command,
		.hljs-prompt,
		.hljs-link_label,
		.hljs-link_url {
			color: #e6db74;
		}

		.hljs-comment,
		.hljs-javadoc,
		.java .hljs-annotation,
		.python .hljs-decorator,
		.hljs-template_comment,
		.hljs-pi,
		.hljs-doctype,
		.hljs-deletion,
		.hljs-shebang,
		.apache .hljs-sqbracket,
		.tex .hljs-formula {
			color: #75715e;
		}

		.coffeescript .javascript,
		.javascript .xml,
		.tex .hljs-formula,
		.xml .javascript,
		.xml .vbscript,
		.xml .css,
		.xml .hljs-cdata,
		.xml .php,
		.php .xml {
			opacity: 0.5;
		}
	</style>
</head>
<body itemscope itemtype='http://schema.org/WebPage'>
	<amp-sidebar id='sidebar' layout='nodisplay'>
		<h2>Categorias</h2>
		<ul>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/back-end/'>
						<span itemprop='name'>back-end</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/cultura/'>
						<span itemprop='name'>cultura</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/data-science/'>
						<span itemprop='name'>data-science</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/design/'>
						<span itemprop='name'>design</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/devops/'>
						<span itemprop='name'>devops</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/eventos/'>
						<span itemprop='name'>eventos</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/front-end/'>
						<span itemprop='name'>front-end</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/mobile/'>
						<span itemprop='name'>mobile</span>
					</a>
				</li>
			
				<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
					<a itemprop='url' href='/amp/vagas/'>
						<span itemprop='name'>vagas</span>
					</a>
				</li>
			
		</ul>
		<h2>Veja também</h2>
		<ul>
			<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
				<a itemprop='url' href='http://carreira.elo7.com.br/engenharia/' target='_blank'>
					<span itemprop='name'>A engenharia</span>
				</a>
			</li>
			<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
				<a itemprop='url' href='http://carreira.elo7.com.br/' target='_blank'>
					<span itemprop='name'>Carreiras</span>
				</a>
			</li>
			<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
				<a itemprop='url' href='http://eventos.elo7.com.br/' target='_blank'>
					<span itemprop='name'>Nossos eventos</span>
				</a>
			</li>
			<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
				<a itemprop='url' href='https://www.elo7.com.br/' target='_blank'>
					<span itemprop='name'>Elo7</span>
				</a>
			</li>
			<li itemscope itemtype='http://schema.org/SiteNavigationElement'>
				<a rel='external' itemprop='url' href='https://github.com/elo7/tech-blog'>Github</a>
			</li>
		</ul>
		</ul>
	</amp-sidebar>
	<header>
		<button class='sidebar-trigger' on='tap:sidebar'>☰</button>
		<a rel='home' itemprop='url' href='/amp/home/' class='logo'></a></header>

	<main itemscope itemtype='http://schema.org/Blog'>
		<article itemprop='blogPost' itemscope itemtype='http://schema.org/BlogPosting' class='post-card post-content'>
	<h1 itemprop='name' class='title'>Novidades do JUnit 5 - parte 1</h1>
	<div class='post-meta'>
		<p class='date'>
			Publicado em: <time datetime='06/11/2017' itemprop='datePublished'>06/11/2017</time>
			<meta itemprop='dateModified' content='06/11/2017'>
		</p>

		<article>
			
				<a data-author='ljtfreitas' itemprop='author' itemscope itemtype='http://schema.org/Person' rel='author' href='/amp/ljtfreitas/' class='author'>
					<meta itemprop='url' content='/amp/ljtfreitas'>
					<span itemprop='name' class='publisher' data-author='ljtfreitas'>@ljtfreitas</span>
					<meta itemprop='worksFor' content='Elo7 Serviços de Informática SA'>
				</a>
			
		</article>
	</div>
	<div class='content' itemprop='articleBody'>
		<p>Em setembro/2017, após pouco mais de um ano de versões <em>milestones</em> e testes, foi lançado o <a href="http://junit.org/junit5/">JUnit 5</a>, a nova versão do principal framework para testes de código na plataforma Java. Essa versão traz várias novas funcionalidades excelentes e algumas mudanças drásticas em relação às versões anteriores.</p>
<p>Este é o primeiro post de uma série sobre o JUnit 5. Aqui, vou tratar das principais mudanças e recursos nesse novo release. No próximo, vou comentar a respeito da migração e adaptação dos testes escritos com JUnit 3/4.</p>
<h2>Arquitetura</h2>
<p>O JUnit foi repensado como uma <strong>plataforma para construção e execução de testes</strong>, de modo que o JUnit 5 é composto por diversos módulos com papéis diferentes (ao invés de &quot;um único framework&quot;):</p>
<pre class="highlight"><code class="hljs mipsasm"><span class="hljs-keyword">JUnit </span><span class="hljs-number">5</span> = <span class="hljs-keyword">JUnit </span>Platform + <span class="hljs-keyword">JUnit </span><span class="hljs-keyword">Jupiter </span>+ <span class="hljs-keyword">JUnit </span>Vintage
</code></pre>
<ul>
<li>
<p><strong>JUnit Platform</strong>: É o responsável pela descoberta e execução de testes na JVM, definindo a relação entre os testes e plataforma de execução (IDEs, console, ferramentas de build). Esse módulo também expõe a interface <a href="http://junit.org/junit5/docs/current/api/org/junit/platform/engine/TestEngine.html">TestEngine</a>, que define o contrato de execução de qualquer ferramenta de testes sobre a plataforma do JUnit.</p>
</li>
<li>
<p><strong>JUnit Jupiter</strong>: Este módulo contém os novos recursos para construção de testes usando o JUnit, e fornece uma implementação de <code>TestEngine</code> para execução dos testes escritos com o JUnit Jupiter. Vamos explorar esse módulo com mais detalhes :)</p>
</li>
<li>
<p><strong>JUnit Vintage</strong>: Fornece um <code>TestEngine</code> para execução de testes escritos em JUnit 3 e 4.</p>
</li>
</ul>
<p>A versão 8 do Java é a mínima requerida para o JUnit 5.</p>
<h2>Suporte para IDEs</h2>
<p>O <a href="http://junit.org/junit5/docs/current/user-guide/#running-tests-ide">suporte nas IDEs</a> ainda está um pouco incipiente. As versões mais recentes do IntelliJ suportam o JUnit 5 (a partir da versão 2016.2; no momento da escrita desse post, a última versão é a 2017.2), mas carregam os jars das versões anteriores (milestones) à versão estável. No Eclipse, a versão 4.7 (Oxygen; a versão mais recente, no momento da escrita desse post) depende da instalação <a href="https://wiki.eclipse.org/JDT_UI/JUnit_5">deste plugin</a>, e a próxima versão (Photon) trará o suporte integrado.</p>
<h2>Dependências</h2>
<p>Dadas as mudanças na arquitetura do JUnit, que anteriormente era um único jar, podemos começar adicionando a seguinte dependência no classpath de testes (os exemplos abaixo usam o <em>pom.xml</em> do Maven):</p>
<pre class="highlight"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-jupiter-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>A dependência acima irá carregar mais alguns artefatos, especialmente, <em>junit-jupiter-engine</em> e <em>junit-platform-engine</em>, necessários para execução na plataforma JUnit. Existem vários outros artefatos, que são descritos detalhadamente na <a href="http://junit.org/junit5/docs/current/user-guide/#installation">documentação oficial</a>. Vamos utilizar mais alguns deles no decorrer do post.</p>
<p>Por agora, temos tudo pronto para começarmos com o JUnit 5, então...ao código!</p>
<h2>Show me the code!</h2>
<p>No JUnit Jupiter, as principais classes e anotações que utilizaremos para escrever nossos testes estão sob o pacote <em>org.junit.jupiter.api</em>.</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assertions.assertEquals;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
        assertEquals(<span class="hljs-number">2</span>, <span class="hljs-number">1</span> + <span class="hljs-number">1</span>);
    }
}
</code></pre>
<p>Para uma olhada inicial, repare no exemplo acima os imports dos novos pacotes. A anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Test.html">@Test</a> continua sendo a referência para denotar um método como um <strong>method test</strong>. A classe <code>Assert</code> não existe mais, sendo substituída pela nova classe <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html">Assertions</a>. Abaixo, vamos ver com mais detalhes essas e outras mudanças.</p>
<h3>@Test</h3>
<p>Como dito acima, a anotação <code>@Test</code> continua sendo a maneira de dizermos ao JUnit que um método específico representa um teste. No JUnit 4, essa anotação tinha dois parâmetros possíveis: <code>timeout</code> e <code>expected</code>; esses parâmetros foram removidos (testes de timeout e exceções agora são feitos de forma diferente, explicados mais adiante). A anotação <code>@Test</code> também pode ser utilizada como uma meta-anotação, caso você queira criar suas próprias <em>annotations</em> para expressar algum significado em particular:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;

<span class="hljs-meta">@Test</span>
<span class="hljs-meta">@Retention</span>(RetentionPolicy.RUNTIME)
<span class="hljs-meta">@Target</span>(ElementType.METHOD)
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> IntegrationTest {
}

...

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@IntegrationTest</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myIntegrationTest</span><span class="hljs-params">()</span> </span>{
        ...
    }
}
</code></pre>
<h3>@BeforeAll, @AfterAll, @BeforeEach, @AfterEach</h3>
<p>As anotações <code>@Before</code> e <code>@After</code> foram substituídas por <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/BeforeEach.html">@BeforeEach</a> e <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/AfterEach.html">@AfterEach</a>. De maneira análoga ao JUnit 4, o metódo anotado com <code>@BeforeEach</code> é executado <strong>antes</strong> de cada teste, e o método anotado com <code>@AfterEach</code>, <strong>após</strong> cada teste.</p>
<p>Do mesmo modo, as anotações <code>@BeforeClass</code> e <code>@AfterClass</code> foram substituídas por <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/BeforeAll.html">@BeforeAll</a> e <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/AfterAll.html">@AfterAll</a>. O método anotado com <code>@BeforeAll</code> é executado antes de <strong>todos</strong> os testes, e o método com <code>@AfterAll</code>, após <strong>todos</strong> os testes. Novamente, de maneira análoga ao JUnit 4, os métodos com essas anotações <strong>devem ser estáticos</strong> (ou o JUnit irá lançar uma exceção). A não ser que...você utilize a nova anotação <code>@TestInstance</code>, explicada abaixo.</p>
<h3>@TestInstance</h3>
<p>O comportamento padrão do JUnit é executar cada teste em uma <strong>nova instância</strong> da classe, devido ao princípio do <a href="http://agileinaflash.blogspot.com.br/2009/02/first.html">isolamento</a>, para que a execução de um teste não interfira em outro. O JUnit sempre se comportou dessa forma e isso continua na versão 5, e é por esse motivo que os métodos anotados com <code>@BeforeAll</code> ou <code>@AfterAll</code> devem ser estáticos (podem ser executados antes/após todos os testes, sem a necessidade de uma instância da classe).</p>
<p>MAS, se por algum motivo você queira alterar esse comportamento, você pode customizar o <em>lifecycle</em> da classe de testes, usando a nova anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/TestInstance.html">@TestInstance</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@TestInstance</span>(TestInstance.Lifecycle.PER_METHOD)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
        assertEquals(<span class="hljs-number">2</span>, <span class="hljs-number">1</span> + <span class="hljs-number">1</span>);
    }
}
</code></pre>
<p>Essa anotação tem um parâmetro do tipo <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/TestInstance.Lifecycle.html">TestInstance.Lifecycle</a>, que é um <em>enum</em> com dois valores possíveis: <code>PER_METHOD</code> (o padrão: uma instância da classe para cada método de teste) e <code>PER_CLASS</code> (uma instância apenas por classe de teste, utilizada para todos os métodos).</p>
<p>Sobre as anotações <code>@BeforeAll</code> e <code>@AfterAll</code>, ao utilizar o lifecycle <em>PER_CLASS</em>, os métodos com essas anotações <strong>não podem ser estáticos</strong>. A <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/TestInstance.html">documentação</a> da anotação comenta a respeito de alguns casos de uso válidos para a utilização do <code>PER_CLASS</code>.</p>
<h3>@DisplayName</h3>
<p>Você pode utilizar essa anotação para fornecer uma descrição mais clara a respeito do que o teste faz. Esse nome será exibido no relatório de saída do JUnit:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"Testes com JUnit 5 😀"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"o resultado de 1 + 1 deve ser 2"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
        assertEquals(<span class="hljs-number">2</span>, <span class="hljs-number">1</span> + <span class="hljs-number">1</span>);
    }
}
</code></pre>
<p>A saída do JUnit (no meu caso, no IntelliJ):</p>
<p><img src="../images/novidades-do-junit-5-parte-1-1.png" alt="A saída do JUnit (no meu caso, no IntelliJ)"></p>
<p>Imagino que não deixaram de reparar no 😀, tanto no código quanto no relatório de saída do teste. Bizarramente, isso sempre foi suportado no JUnit (!). Como a própria <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-display-names">documentação</a> incluiu um exemplo, aparentemente os emojis estão oficialmente liberados!</p>
<h3>Assertions</h3>
<p>A classe <code>Assert</code>, a classe mais utilizada para escrita de testes com o JUnit, foi substituída pela nova classe <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html">Assertions</a>, que tem o mesmo propósito: fornecer os métodos <em>assert</em>, utilizados para validar as condições que determinam se um teste passou ou não. Os métodos das versões anteriores continuam existindo (assertEquals/notEquals, assertSame/notSame, assertTrue/False, fail, etc), com uma diferença: esses métodos eram (e continuam sendo) sobrecarregados para permitir ao usuário informar uma mensagem explicativa para o caso do teste falhar. Nas versões anteriores, esse argumento (do tipo String) era o <strong>primeiro parâmetro</strong> do método, e, no JUnit 5, passa a ser o <strong>último</strong>.</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// antes -&gt; assertEquals("o resultado esperado desse teste é 2...a soma está correta?", 2, 5 + 3);</span>

        <span class="hljs-comment">//agora</span>
        assertEquals(<span class="hljs-number">2</span>, <span class="hljs-number">5</span> + <span class="hljs-number">3</span>, <span class="hljs-string">"o resultado esperado desse teste é 2...a soma está correta?"</span>);
    }
}
</code></pre>
<p>Também é possível informar um <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html">Supplier<String></a> para fornecer a mensagem.</p>
<p>Um novo método muito útil é o <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html#assertAll-org.junit.jupiter.api.function.Executable...-">assertAll</a>, que permite executar um conjunto de testes para serem validados em conjunto:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    Person person = <span class="hljs-keyword">new</span> Person();
    person.name = <span class="hljs-string">"Tiago"</span>;
    person.age = <span class="hljs-number">32</span>;

    assertAll(
            () -&gt; assertEquals(<span class="hljs-string">"Tiago de Freitas Lima"</span>, person.name), <span class="hljs-comment">//falha</span>
            () -&gt; assertEquals(<span class="hljs-number">20</span>, person.age) <span class="hljs-comment">//falha (queria que não falhasse)</span>
    );
}

<span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{

    String name;
    <span class="hljs-keyword">int</span> age;
}
</code></pre>
<p>A saída do JUnit:</p>
<pre class="highlight"><code class="hljs java">org.opentest4j.MultipleFailuresError: <span class="hljs-function">Multiple <span class="hljs-title">Failures</span> <span class="hljs-params">(<span class="hljs-number">2</span> failures)</span>
    expected: &lt;Tiago de Freitas Lima&gt; but was: &lt;Tiago&gt;
    expected: &lt;20&gt; but was: &lt;32&gt;
</span></code></pre>
<p>No exemplo acima, enviamos para o método <code>assertAll</code> duas expressões lambda do tipo <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/function/Executable.html">Executable</a>, que é um novo objeto do JUnit para representar um bloco de código (Executable é uma interface funcional). O teste irá quebrar, e o relatório exibirá cada falha de maneira individual. O teste passará apenas quando todos os testes enviados para o <code>assertAll</code> passarem. Uma observação: como o parâmetro desse método é um <em>varargs</em> do tipo Executable (há uma sobrecarga que recebe um Stream), o parâmetro que representa a mensagem a ser exibida em caso de falha é o <strong>primeiro argumento</strong> (sim, é uma exceção ao que escrevi no parágrafo anterior...).</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    Person person = <span class="hljs-keyword">new</span> Person();
    person.name = <span class="hljs-string">"Tiago"</span>;
    person.age = <span class="hljs-number">32</span>;

    assertAll(<span class="hljs-string">"Há algo errado com essa pessoa..."</span>
            () -&gt; assertEquals(<span class="hljs-string">"Tiago de Freitas Lima"</span>, person.name), <span class="hljs-comment">//falha</span>
            () -&gt; assertEquals(<span class="hljs-number">20</span>, person.age) <span class="hljs-comment">//falha</span>
    );
}
</code></pre>
<p>Outro novo método é o <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html#assertThrows-java.lang.Class-org.junit.jupiter.api.function.Executable-">assertThrows</a>, para testes de código que lançam exceções (no JUnit 4, usaríamos o parâmetro <code>expected</code> da anotação <code>@Test</code>):</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    assertThrows(IllegalArgumentException.class,
        () -&gt; {<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"argumento invalido!"</span>);});
}
</code></pre>
<p>O primeiro parâmetro é o tipo da exceção esperada, e o segundo é um Executable. Se a execução do bloco não lançar a exceção esperada, o teste irá falhar.</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    assertThrows(IllegalArgumentException.class,
        () -&gt; {});
}

<span class="hljs-comment">//falha</span>
<span class="hljs-comment">//org.opentest4j.AssertionFailedError: Expected java.lang.IllegalArgumentException to be thrown, but nothing was thrown.</span>
</code></pre>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    assertThrows(IllegalArgumentException.class,
        () -&gt; {<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"uma excecao qualquer"</span>);});
}

<span class="hljs-comment">//falha</span>
<span class="hljs-comment">//Unexpected exception type thrown ==&gt; expected: &lt;java.lang.IllegalArgumentException&gt; but was: &lt;java.lang.RuntimeException&gt;</span>
</code></pre>
<p>Eventualmente, você pode querer capturar a exceção lançada para implementar alguma validação, como verificar se a mensagem está correta ou se alguma informação adicional que seu código deve incluir na exceção está mesmo sendo enviada. No JUnit 4, poderíamos usar a classe <a href="http://junit.org/junit4/javadoc/latest/org/junit/rules/ExpectedException.html">ExpectedException</a> para esse propósito, mas no JUnit 5 o método <code>assertThrows</code> é o suficiente para atender essa necessidade:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">//assrtThrows retorna a exceção lançada</span>
    IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
        () -&gt; {<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"argumento invalido!"</span>);});

    assertEquals(<span class="hljs-string">"argumento invalido!"</span>, exception.getMessage());
}
</code></pre>
<p>Outra necessidade que pode ocorrer durante a escrita de testes é a verificação de <em>timeouts</em>. No JUnit 4, duas maneiras possíveis de fazer isso eram utilizar o parâmetro <code>timeout</code> da anotação <code>@Test</code>, ou a classe <a href="http://junit.org/junit4/javadoc/latest/org/junit/rules/Timeout.html">Timeout</a>. Essas duas abordagem compartilhavam do seguinte problema: o JUnit iniciava a medição do tempo de execução a partir do <strong>início do método do teste</strong>, quando na verdade a intenção do programador é verificar o timeout apenas do código a ser testado. Uma maneira mais elegante de atender esse caso de uso é o método <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html#assertTimeout-java.time.Duration-org.junit.jupiter.api.function.Executable-">assertTimeout</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    assertTimeout(Duration.ofMillis(<span class="hljs-number">1000</span>), () -&gt; Thread.sleep(<span class="hljs-number">2000</span>));
}
</code></pre>
<p>O primeiro argumento é um objeto do tipo Duration, que é uma classe introduzida no Java 8 que representa uma &quot;quantidade de tempo&quot;, no exemplo, 1000 milissegundos (essa classe tem <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html">vários métodos</a> de criação). O segundo parâmetro é um <code>Executable</code>; no exemplo, a execução do bloco está durando 2000 milissegundos, estourando o timeout que informamos. O teste irá falhar com a seguinte mensagem:</p>
<pre class="highlight"><code class="hljs java">org.opentest4j.AssertionFailedError: execution exceeded timeout of <span class="hljs-number">1000</span> ms by <span class="hljs-number">1003</span> ms
</code></pre>
<p>O relatório exibe a diferença entre o tempo total da execução e o timeout esperado. Mas como o JUnit sabe o tempo total? A resposta é que a execução aguardou o bloco terminar, porque o <code>Executable</code> <strong>foi executado na mesma thread do teste</strong>. Isso é útil, mas nem sempre é o desejado. Afinal, suponha um cenário onde o seu timeout é, digamos, 2 segundos; se o código demorar 3 segundos ou uma hora, o fato é que o timeout esperado foi excedido e não é necessário esperar até o fim da execução para &quot;descobrirmos&quot; o problema. Para isso, existe o método <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html#assertTimeoutPreemptively-java.time.Duration-org.junit.jupiter.api.function.Executable-">assertTimeoutPreemptively</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    assertTimeoutPreemptively(Duration.ofMillis(<span class="hljs-number">1000</span>), () -&gt; Thread.sleep(<span class="hljs-number">2000</span>));
}
</code></pre>
<p>O método <em>assertTimeoutPreemptively</em> executa o bloco <strong>em outra thread</strong>, de modo que a execução é imediatamente interrompida caso o timeout seja excedido. No exemplo acima, o teste falha com a mensagem:</p>
<pre class="highlight"><code class="hljs java">org.opentest4j.AssertionFailedError: execution timed out after <span class="hljs-number">1000</span> ms
</code></pre>
<p>Outra situação que pode ocorrer é você querer obter o retorno do método que está sendo executado no <code>assertTimeout/Preemptively</code>, para realizar alguma validação. Isso é perfeitamente possível:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    Person person = <span class="hljs-keyword">new</span> Person();
    person.name = <span class="hljs-string">"Tiago"</span>;
    person.age = <span class="hljs-number">32</span>;

    String message = assertTimeout(Duration.ofMillis(<span class="hljs-number">2000</span>), person::message);

    assertEquals(<span class="hljs-string">"Hello Tiago, your age is 32"</span>, message);
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{

    String name;
    <span class="hljs-keyword">int</span> age;

    <span class="hljs-function">String <span class="hljs-title">message</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        Thread.sleep(<span class="hljs-number">1000</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello "</span> + name + <span class="hljs-string">", your age is "</span> + age;
    }
}
</code></pre>
<p>Uma observação: o segundo parâmetro dos métodos <code>assertTimeout/Preemptively</code> é um objeto do tipo <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/function/ThrowingSupplier.html">ThrowingSupplier</a>, que representa um bloco de código que devolve algum valor qualquer e pode lançar uma exceção.</p>
<p>Outras utilidades:</p>
<ul>
<li>os métodos <code>assertTrue</code> e <code>assertFalse</code> também passam a aceitar argumentos do tipo <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/BooleanSupplier.html">BooleanSupplier</a></li>
<li>método para comparação de objetos do tipo <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html">Iterable</a>, como coleções: <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html#assertIterableEquals-java.lang.Iterable-java.lang.Iterable-">assertIterableEquals</a></li>
<li>método para comparação de duas listas do tipo String (?): <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html#assertLinesMatch-java.util.List-java.util.List-">assertLinesMatch</a></li>
<li>lista completa de métodos: <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html">Assertions</a>, e exemplos mais elaborados na <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-assertions">documentação</a>.</li>
</ul>
<p>E, claro, o exemplo que não poderia faltar :):</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    assertEquals(<span class="hljs-string">"😀"</span>, <span class="hljs-string">"🤔"</span>);
}

<span class="hljs-comment">//falha</span>
org.opentest4j.AssertionFailedError:
Expected :😀
Actual   :🤔
</code></pre>
<h3>Assumptions</h3>
<p>Um recurso muito útil mas não muito utilizado é a API de <a href="https://github.com/junit-team/junit4/wiki/Assumptions-with-assume">Assumptions</a> do JUnit, representada pela classe <a href="http://junit.org/junit4/javadoc/latest/org/junit/Assume.html">Assume</a> (introduzida no JUnit 4). Essa API permite você tornar o seu teste mais defensivo, no sentido que você pode verificar condições que serão &quot;assumidas&quot; na execução do teste, como, digamos, alguma variável de ambiente, um timezone específico, e outras condições externas que o seu código irá &quot;assumir&quot; como verdadeiras. Se alguma dessas pré-condições falhar (digamos, uma determinada variável de ambiente não está definida com um valor em particular), o teste será <strong>ignorado</strong> pelo JUnit, ao invés de falhar.</p>
<p>Esse recurso continua disponível no JUnit 5, agora na classe <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assumptions.html">Assumptions</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assumptions.assumeTrue;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
        assumeTrue(<span class="hljs-string">"CI"</span>.equals(System.getProperty(<span class="hljs-string">"ENV"</span>))); <span class="hljs-comment">//teste executado apenas no ambiente CI</span>
        ...
    }
}
</code></pre>
<p>Lembrando que no caso da condição acima não ser verdadeira, o teste será <strong>ignorado</strong>:</p>
<pre class="highlight"><code class="hljs java">org.opentest4j.TestAbortedException: Assumption failed: assumption is not <span class="hljs-keyword">true</span>
</code></pre>
<h3>Tags</h3>
<p>O JUnit 4 possui a anotação <a href="http://junit.org/junit4/javadoc/latest/org/junit/experimental/categories/Category.html">@Category</a>, que permite associar um teste com uma determinada &quot;categoria&quot; de testes, que posteriormente podem ser agrupados em uma suite. Como exemplo, você poderia categorizar todos os seus testes &quot;lentos&quot; (que acessam bancos de dados ou recursos externos), agrupá-los e executá-los apenas em um momento específico do build da aplicação. O uso dessa anotação era um pouco complicado porque era necessário criar uma interface vazia para representar a &quot;categoria&quot;. O JUnit 5 simplificou esse modelo, introduzindo a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Tag.html">@Tag</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@Tag</span>(<span class="hljs-string">"fast"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-meta">@Tag</span>(<span class="hljs-string">"sample"</span>)
    <span class="hljs-meta">@Tag</span>(<span class="hljs-string">"basic"</span>) <span class="hljs-comment">//pode ser repetida</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myFirstJUnit5Test</span><span class="hljs-params">()</span> </span>{
    }
}
</code></pre>
<p>Do mesmo que a anotação <code>@Category</code> da versão anterior, a anotação <code>@Tag</code> pode ser utilizada para filtros e agrupamento de testes.</p>
<h3>Testes aninhados</h3>
<p>Eventualmente, queremos testar uma classe que possui vários métodos, cuja execução depende do estado interno do objeto. Para alguns testes, precisamos inicializar esse objeto de determinado modo; em outros testes, a configuração deve ser diferente para que o uso de outro método seja possível. Podemos criar vários métodos na mesma classe de teste, o que pode tornar o entendimento um pouco confuso; outra abordagem possível seria criar testes separados e agrupá-los em uma suite. O fato é que esses testes fazem parte do mesmo contexto, que é o objeto sendo testado, e queremos que eles rodem em conjunto. O JUnit 5 introduziu uma maneira elegante de resolver esse cenário: a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Nested.html">@Nested</a>.</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StackTest</span> </span>{

    <span class="hljs-keyword">private</span> Stack&lt;String&gt; stack;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"is instantiated with new Stack()"</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">isInstantiatedWithNew</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">new</span> Stack&lt;&gt;();
    }

    <span class="hljs-meta">@Nested</span>
    <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"when new"</span>)
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhenNew</span> </span>{

        <span class="hljs-meta">@BeforeEach</span>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">createNewStack</span><span class="hljs-params">()</span> </span>{
            stack = <span class="hljs-keyword">new</span> Stack&lt;&gt;();
        }

        <span class="hljs-meta">@Test</span>
        <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"is empty"</span>)
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>{
            assertTrue(stack.isEmpty());
        }

        <span class="hljs-meta">@Test</span>
        <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"throws EmptyStackException when popped"</span>)
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">throwsExceptionWhenPopped</span><span class="hljs-params">()</span> </span>{
            assertThrows(EmptyStackException.class, () -&gt; stack.pop());
        }

        <span class="hljs-meta">@Test</span>
        <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"throws EmptyStackException when peeked"</span>)
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">throwsExceptionWhenPeeked</span><span class="hljs-params">()</span> </span>{
            assertThrows(EmptyStackException.class, () -&gt; stack.peek());
        }

        <span class="hljs-meta">@Nested</span>
        <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"after pushing an element"</span>)
        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AfterPushing</span> </span>{

            String anElement = <span class="hljs-string">"an element"</span>;

            <span class="hljs-meta">@BeforeEach</span>
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushAnElement</span><span class="hljs-params">()</span> </span>{
                stack.push(anElement);
            }

            <span class="hljs-meta">@Test</span>
            <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"it is no longer empty"</span>)
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">isNotEmpty</span><span class="hljs-params">()</span> </span>{
                assertFalse(stack.isEmpty());
            }

            <span class="hljs-meta">@Test</span>
            <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"returns the element when popped and is empty"</span>)
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">returnElementWhenPopped</span><span class="hljs-params">()</span> </span>{
                assertEquals(anElement, stack.pop());
                assertTrue(stack.isEmpty());
            }

            <span class="hljs-meta">@Test</span>
            <span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"returns the element when peeked but remains not empty"</span>)
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">returnElementWhenPeeked</span><span class="hljs-params">()</span> </span>{
                assertEquals(anElement, stack.peek());
                assertFalse(stack.isEmpty());
            }
        }
    }
}
</code></pre>
<p>Extraí esse exemplo da <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-nested">documentação</a>. No teste acima, testamos vários métodos da classe <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Stack.html">Stack</a> (da API do Java), em várias situações diferentes, usando <em>classes aninhadas</em>. O interessante é que cada contexto de uso da classe é representado por um teste em particular, mas que fazem sentido quando executados de forma agrupada. Podemos fazer uso do <code>@DisplayName</code> (como no exemplo acima) para gerar uma saída como essa:</p>
<p><div class='post-image'><amp-img on='tap:lightbox-1' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-2.png' layout='fixed' height='183' width='272' alt='Testes aninhados'></amp-img><amp-image-lightbox id='lightbox-1' layout='nodisplay'></amp-image-lightbox></div></p>
<h3>Testes parametrizados</h3>
<p>Os <a href="https://github.com/junit-team/junit4/wiki/Parameterized-tests"><em>testes parametrizados</em></a> foram uma novidade introduzida no JUnit 4, que permitiam executar o mesmo conjunto de testes sobre argumentos diferentes. Esse recurso é muito útil, uma vez que, se quisermos testar o mesmo código com parâmetros diferentes, a alternativa seria criarmos outro teste (com os testes parametrizados, basta adicionar uma nova entrada de argumentos). Essa API foi completamente modificada no JUnit 5.</p>
<p>O suporte para testes parametrizados está em um módulo separado do core do JUnit Jupiter, de modo que precisamos adicionar a seguinte dependência:</p>
<pre class="highlight"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-jupiter-params<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>No JUnit 4, o modelo de programação utilizado é criar um <em>factory method</em> estático que agrega os valores em um array bidimensional, e os parâmetros são injetados no construtor da classe de teste (um exemplo <a href="http://junit.org/junit4/javadoc/latest/org/junit/runners/Parameterized.html">aqui</a>). Na nova versão, podemos injetar os parâmetros diretamente no método:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.ParameterizedTest;
<span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.ValueSource;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@ValueSource</span>(strings = { <span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span> }) <span class="hljs-comment">// lista de parâmetros</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument)</span> </span>{
        assertNotNull(argument); <span class="hljs-comment">//esse teste será executado uma vez para cada argumento: "Hello" e "World"</span>
    }
}
</code></pre>
<p>Para um teste parametrizado, devemos utilizar a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/ParameterizedTest.html">ParameterizedTest</a>, ao invés de <code>@Test</code>. A anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/ValueSource.html">ValueSource</a> funciona como um <em>parameter provider</em>, fornecendo os valores que serão injetados via argumento do método. Essa anotação possui outros parâmetros possíveis, para valores de outros tipos como <code>ints</code>, <code>doubles</code> e <code>longs</code>.</p>
<p>A saída padrão do teste fornece um feedback bem útil a respeito de cada execução:</p>
<p><div class='post-image'><amp-img on='tap:lightbox-2' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-3.png' layout='fixed' height='180' width='272' alt='Testes parametrizados'></amp-img><amp-image-lightbox id='lightbox-2' layout='nodisplay'></amp-image-lightbox></div></p>
<p>Também podemos customizar o relatório, se desejarmos:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@ParameterizedTest</span>(name =  <span class="hljs-string">"Parameterized test {index}: {0}"</span>)
<span class="hljs-meta">@ValueSource</span>(strings = { <span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span> })
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument)</span> </span>{
    assertNotNull(argument);
}
</code></pre>
<p><div class='post-image'><amp-img on='tap:lightbox-3' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-4.png' layout='fixed' height='183' width='272' alt='Testes parametrizados - relatório customizado'></amp-img><amp-image-lightbox id='lightbox-3' layout='nodisplay'></amp-image-lightbox></div></p>
<p>Outra possibilidade para injeção de parâmetros é a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/EnumSource.html">EnumSource</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.EnumSource;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>(name =  <span class="hljs-string">"Parameterized test {index}: {0}"</span>)
    <span class="hljs-meta">@EnumSource</span>(TimeUnit.class)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(TimeUnit timeUnit)</span> </span>{
        assertNotNull(timeUnit); <span class="hljs-comment">//o teste será executado para cada elemento do enum</span>
    }
}
</code></pre>
<p>No exemplo, utilizei o enum <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html">TimeUnit</a>, da API padrão do Java 8. A anotação <code>@EnumSource</code> irá utilizar o enum como fonte dos parâmetros, rodando o teste para cada elemento do enum. Outra possibilidade dessa anotação é incluir/excluir seletivamente os items do enum a partir do nome.</p>
<p>Uma terceira maneira é fornecer um método gerador de parâmetros:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.MethodSource;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@MethodSource</span>(<span class="hljs-string">"parameterFactory"</span>) <span class="hljs-comment">//metodo gerador de parâmetros</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument)</span> </span>{
        assertNotNull(argument);
    }

    <span class="hljs-function"><span class="hljs-keyword">static</span> Collection&lt;String&gt; <span class="hljs-title">parameterFactory</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span>);
    }
}
</code></pre>
<p>A anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/MethodSource.html">MethodSource</a> permite fornecer um array de nomes de métodos que funcionarão como fábrica de parâmetros para o teste; os tipos de retorno possíveis são Stream, Iterator ou Iterable (por exemplo, uma coleção ou array de valores). O método de fábrica <strong>deve ser estático</strong>, a não ser que a classe esteja anotada com <code>@TestInstance(Lifecycle.PER_CLASS)</code>.</p>
<p>E se quisermos vários argumentos? Podemos fornecer uma coleção do objeto <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/Arguments.html">Arguments</a>, que representa um array de argumentos:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.Arguments;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@MethodSource</span>(<span class="hljs-string">"parameterFactory"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument, <span class="hljs-keyword">int</span> count)</span> </span>{
        assertNotNull(argument);
        assertTrue(count &gt; <span class="hljs-number">0</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">static</span> Collection&lt;Arguments&gt; <span class="hljs-title">parameterFactory</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(Arguments.of(<span class="hljs-string">"Hello"</span>, <span class="hljs-number">1</span>), Arguments.of(<span class="hljs-string">"World"</span>, <span class="hljs-number">1</span>));
    }
}
</code></pre>
<p>Outra possibilidade é fornecer argumentos no formato <em>csv</em> (valores separados por vírgula), usando a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/CsvSource.html">CsvSource</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.CsvSource;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@CsvSource</span>({ <span class="hljs-string">"Hello, 1"</span>, <span class="hljs-string">"World, 2"</span>}) <span class="hljs-comment">//o separador padrão é ",". É possível customizar usando o argumento "delimiter"</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument, <span class="hljs-keyword">int</span> count)</span> </span>{
        assertNotNull(argument);
        assertTrue(count &gt; <span class="hljs-number">0</span>);
    }
}
</code></pre>
<p>Ou em um arquivo csv externo, usando a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/CsvFileSource.html">CsvFileSource</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.CsvFileSource;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@CsvFileSource</span>(resources = <span class="hljs-string">"/parameters.csv"</span>) <span class="hljs-comment">//deve estar no classpath de testes</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument, <span class="hljs-keyword">int</span> count)</span> </span>{
        assertNotNull(argument);
        assertTrue(count &gt; <span class="hljs-number">0</span>);
    }
}
</code></pre>
<p>O arquivo <code>parameters.csv</code> (o parâmetro <code>resources</code> é um array, permitindo que vários arquivos possam ser utilizados para o mesmo teste):</p>
<pre class="highlight"><code class="hljs autohotkey"><span class="hljs-built_in">Hello,</span> <span class="hljs-number">1</span>
<span class="hljs-built_in">World,</span> <span class="hljs-number">2</span>
</code></pre>
<p>Ufa! Quantas opções...E se ainda assim você não estiver satisfeito ou precisar de algo mais específico, você ainda pode criar o seu próprio <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/ArgumentsProvider.html">ArgumentsProvider</a>!</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.ArgumentsSource;
<span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.ArgumentsProvider;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@ArgumentsSource</span>(CustomArgumentProvider.class)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument, <span class="hljs-keyword">int</span> count)</span> </span>{
        assertNotNull(argument);
        assertTrue(count &gt; <span class="hljs-number">0</span>);
    }

    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomArgumentProvider</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ArgumentsProvider</span> </span>{

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> Stream&lt;? extends Arguments&gt; provideArguments(ExtensionContext context) <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-comment">// aqui você poderia implementar a leitura de qualquer fonte de dados para o seu teste,</span>
            <span class="hljs-comment">// como um arquivo texto, planilha, etc</span>

            <span class="hljs-keyword">return</span> Stream.of(Arguments.of(<span class="hljs-string">"Hello"</span>, <span class="hljs-number">1</span>), Arguments.of(<span class="hljs-string">"World"</span>, <span class="hljs-number">1</span>));
        }
    }
}
</code></pre>
<p>No exemplo acima, criamos uma classe que implementa <code>ArgumentsProvider</code> e referenciamos no teste usando a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/provider/ArgumentsSource.html">ArgumentsSource</a>. Uma implementação mais complexa poderia ser encapsulada em uma meta-anotação reutilizável:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.ArgumentsProvider;
<span class="hljs-keyword">import</span> org.junit.jupiter.params.provider.ArgumentsSource;
<span class="hljs-keyword">import</span> org.junit.jupiter.params.support.AnnotationConsumer;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@ParameterizedTest</span>
    <span class="hljs-meta">@ExcelSource</span>(file =  <span class="hljs-string">"test.xls"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parameterizedTest</span><span class="hljs-params">(String argument)</span> </span>{
        assertNotNull(argument);
    }

    <span class="hljs-meta">@ArgumentsSource</span>(ExcelArgumentProvider.class)
    <span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> ExcelSource {

        <span class="hljs-function">String <span class="hljs-title">file</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// nome do arquivo</span>
    }

    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExcelArgumentProvider</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ArgumentsProvider</span>, <span class="hljs-title">AnnotationConsumer</span>&lt;<span class="hljs-title">ExcelSource</span>&gt; </span>{

        <span class="hljs-keyword">private</span> String fileName;

        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(ExcelSource excelSource)</span> </span>{
            <span class="hljs-keyword">this</span>.fileName = excelSource.file(); <span class="hljs-comment">//obtem os parâmetros da anotação</span>
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> Stream&lt;? extends Arguments&gt; provideArguments(ExtensionContext context) <span class="hljs-keyword">throws</span> Exception {
            <span class="hljs-comment">// implementa a leitura do arquivo excel...</span>
            <span class="hljs-keyword">return</span> Stream.empty();
        }
    }
}
</code></pre>
<p>No exemplo mais elaborado acima, criamos uma anotação chamada <code>ExcelSource</code> para utilizarmos em testes que utilizam um arquivo Excel como fonte de dados. Nossa anotação <strong>precisa</strong> ser anotada com <code>ArgumentsSource</code>, referenciando a classe fornecedora de parâmetros (no exemplo, <code>ExcelArgumentProvider</code>). No <em>provider</em>, também implementamos a interface <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/params/support/AnnotationConsumer.html">AnnotationConsumer</a>, para termos acesso aos parâmetros da anotação customizada.</p>
<p>Mais exemplos e casos de uso de testes parametrizados podem ser encontrados na <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">documentação</a>.</p>
<h3>Repetição de testes</h3>
<p>Outro novo recurso do JUnit 5 é a anotação <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/RepeatedTest.html">RepeatedTest</a>, que permite a <em>repetição</em> de um determinado teste &quot;n&quot; vezes.</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@RepeatedTest</span>(<span class="hljs-number">10</span>) <span class="hljs-comment">//número de repetições</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">repeatedTest</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">//esse teste será executado 10 vezes</span>
}
</code></pre>
<p><div class='post-image'><amp-img on='tap:lightbox-4' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-5.png' layout='fixed' height='184' width='272' alt='Teste com repetição'></amp-img><amp-image-lightbox id='lightbox-4' layout='nodisplay'></amp-image-lightbox></div></p>
<p>A anotação também possui um parâmetro <code>name</code> que podemos utilizar para customizar a saída do teste:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@RepeatedTest</span>(value = <span class="hljs-number">10</span>, name = <span class="hljs-string">"Repeat, please: {currentRepetition}/{totalRepetitions}"</span>)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">repeatedTest</span><span class="hljs-params">()</span> </span>{
    assertNotNull(<span class="hljs-string">"JUNIT 5"</span>);
}
</code></pre>
<p><div class='post-image'><amp-img on='tap:lightbox-5' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-6.png' layout='fixed' height='182' width='272' alt='Teste com repetição'></amp-img><amp-image-lightbox id='lightbox-5' layout='nodisplay'></amp-image-lightbox></div></p>
<p>Caso seja necessário, podemos injetar um parâmetro do tipo <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/RepetitionInfo.html">RepetitionInfo</a>, um objeto que contém as informações da repetição atual:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@RepeatedTest</span>(value = <span class="hljs-number">2</span>)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">repeatedTest</span><span class="hljs-params">(RepetitionInfo repetitionInfo)</span> </span>{
    fail(<span class="hljs-string">"Repetição: "</span> + repetitionInfo.getCurrentRepetition() + <span class="hljs-string">"/"</span> + repetitionInfo.getTotalRepetitions());
}

<span class="hljs-comment">//como quebrei o teste propositalmente, a saída de cada execução seria:</span>
<span class="hljs-comment">//org.opentest4j.AssertionFailedError: Repetição: 1/2</span>
<span class="hljs-comment">//org.opentest4j.AssertionFailedError: Repetição: 2/2</span>
</code></pre>
<p>Embora a utilização dessa anotação possa soar estranha, há algumas aplicações muito válidas. Imagine uma implementação de geração de números aleatórios, que devem estar contidos dentro de um determinado intervalo, dado um valor de <code>seed</code>. Seria uma ótima abordagem testar esse código muitas vezes, para garantir que a geração randômica está funcionando dentro dos parâmetros esperados; poderíamos fazer isso com um <code>loop</code>, mas essa abordagem sobrecarrega o teste com uma lógica adicional que prejudica o entendimento. A anotação <code>@RepeatedTest</code> torna essa tarefa trivial.</p>
<h3>Testes dinâmicos</h3>
<p>Os <em>method tests</em> exemplificados acima, e que estamos acostumados a fazer, são testes &quot;estáticos&quot;, no sentido que não são diretamente influenciados por variáveis &quot;externas&quot; ao ambiente, e são compilados com a classe de teste. Os <code>Assumptions</code> e as várias formas de <code>@ParameterizedTests</code> fornecem uma maneira simples de construirmos testes verificando pré-condições e valores dinâmicos, mas sua expressividade têm algumas limitações.</p>
<p>De todo modo, no JUnit, na grande maioria dos casos, isso é mais que o suficiente: nosso teste é representado por um método cujo nome representa o que queremos testar; criamos uma entrada (estática ou dinâmica), exercitamos o código, e verificamos se a saída/pós-condições foram atendidas. No JUnit 5, há uma maneira de repensar um pouco esse modelo de criação de testes, tornando possível a <strong>construção do teste em tempo de execução</strong>: podemos decidir, <em>em tempo de código</em>, o que será será testado e como será testado. Essa nova abordagem são os <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-dynamic-tests">testes dinâmicos</a>.</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.DynamicTest;
<span class="hljs-keyword">import</span> org.junit.jupiter.api.TestFactory;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.DynamicTest.dynamicTest;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@TestFactory</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Collection&lt;DynamicTest&gt; <span class="hljs-title">dynamicTests</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(
                dynamicTest(<span class="hljs-string">"1st dynamic test"</span>, () -&gt; assertTrue(<span class="hljs-keyword">true</span>)),
                dynamicTest(<span class="hljs-string">"2nd dynamic test"</span>, () -&gt; assertEquals(<span class="hljs-number">2</span>, <span class="hljs-number">1</span> + <span class="hljs-number">1</span>))
        );
    }
}
</code></pre>
<p>Os testes dinâmicos são criados em um método anotado com <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/TestFactory.html">TestFactory</a>, que deve retornar uma coleção/array/stream de <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/DynamicTest.html">DynamicTests</a>. Para criar uma instância desse tipo, utilizamos o método <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/DynamicTest.html#dynamicTest-java.lang.String-org.junit.jupiter.api.function.Executable-">dynamicTest</a>, informando o <em>display name</em> do teste e um Executable que representa o teste em si.</p>
<p>A execução do teste acima tem essa saída:</p>
<p><div class='post-image'><amp-img on='tap:lightbox-6' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-7.png' layout='fixed' height='185' width='272' alt='Testes dinâmicos'></amp-img><amp-image-lightbox id='lightbox-6' layout='nodisplay'></amp-image-lightbox></div></p>
<p>Como o teste é construído no código, podemos parâmetriza-lo facilmente usando os próprios recursos comuns do Java:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-meta">@TestFactory</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> Stream&lt;DynamicTest&gt; <span class="hljs-title">dynamicTests</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> Stream.of(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span>)
            .flatMap(input -&gt; Stream.of(
                    dynamicTest(input + <span class="hljs-string">" has length &gt; 0"</span>, () -&gt; assertTrue(input.length() &gt; <span class="hljs-number">0</span>)),
                    dynamicTest(input + <span class="hljs-string">" is not empty"</span>, () -&gt; assertFalse(input.isEmpty()))
            ));
}
</code></pre>
<p>A saída do teste acima:</p>
<p><div class='post-image'><amp-img on='tap:lightbox-7' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-8.png' layout='fixed' height='183' width='272' alt='Testes dinâmicos'></amp-img><amp-image-lightbox id='lightbox-7' layout='nodisplay'></amp-image-lightbox></div></p>
<p>Também poderíamos, dinamicamente, organizar o teste acima de maneira equivalente ao que fizemos com os <em>nested tests</em>, usando as classes <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/DynamicContainer.html">DynamicContainer</a> e <a href="http://junit.org/junit5/docs/current/api/org/junit/jupiter/api/DynamicNode.html">DynamicNode</a>:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.DynamicNode;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.DynamicContainer.dynamicContainer;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> </span>{

    <span class="hljs-meta">@TestFactory</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Stream&lt;DynamicNode&gt; <span class="hljs-title">dynamicTests</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Stream.of(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span>)
            .map(input -&gt; dynamicContainer(<span class="hljs-string">"using "</span> + input, Stream.of(
                    dynamicTest(input + <span class="hljs-string">" is not null"</span>, () -&gt; assertNotNull(input)),
                    dynamicContainer(<span class="hljs-string">"check properties of "</span> + input, Stream.of(
                            dynamicTest(input + <span class="hljs-string">" has length &gt; 0"</span>, () -&gt; assertTrue(input.length() &gt; <span class="hljs-number">0</span>)),
                            dynamicTest(input + <span class="hljs-string">" is not empty"</span>, () -&gt; assertFalse(input.isEmpty()))
                    ))
            )));
    }
}
</code></pre>
<p>O teste acima gera o seguinte relatório:</p>
<p><div class='post-image'><amp-img on='tap:lightbox-8' role='button' tabindex='0' src='../../images/novidades-do-junit-5-parte-1-9.png' layout='fixed' height='182' width='272' alt='Testes dinâmicos'></amp-img><amp-image-lightbox id='lightbox-8' layout='nodisplay'></amp-image-lightbox></div></p>
<p>Mais exemplos na <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-dynamic-tests">documentação</a>.</p>
<h3>Interfaces para testes</h3>
<p>O JUnit 5 permite que que as anotações que vimos acima sejam incluídas em métodos <em>default</em> de interfaces. Isso abre algumas possibilidades interessantes; podemos criar interfaces que representem uma espécie de &quot;template&quot; de testes, e incluir essas interfaces na assinatura das classes de teste específicas. O exemplo abaixo consta na <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-test-interfaces-and-default-methods">documentação</a>, e demonstra o uso de uma interface para testar o contrato do método <code>equals</code> de objetos:</p>
<pre class="highlight"><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Testable</span>&lt;<span class="hljs-title">T</span>&gt; </span>{

    <span class="hljs-function">T <span class="hljs-title">createValue</span><span class="hljs-params">()</span></span>;

}

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EqualsContract</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">Testable</span>&lt;<span class="hljs-title">T</span>&gt; </span>{

    <span class="hljs-function">T <span class="hljs-title">createNotEqualValue</span><span class="hljs-params">()</span></span>;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">valueEqualsItself</span><span class="hljs-params">()</span> </span>{
        T value = createValue();
        assertEquals(value, value);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">valueDoesNotEqualNull</span><span class="hljs-params">()</span> </span>{
        T value = createValue();
        assertFalse(value.equals(<span class="hljs-keyword">null</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">valueDoesNotEqualDifferentValue</span><span class="hljs-params">()</span> </span>{
        T value = createValue();
        T differentValue = createNotEqualValue();
        assertNotEquals(value, differentValue);
        assertNotEquals(differentValue, value);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnit5Test</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">EqualsContract</span>&lt;<span class="hljs-title">String</span>&gt; </span>{

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">createValue</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello"</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">createNotEqualValue</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"World"</span>;
    }

}
</code></pre>
<p>Os <em>asserts</em> estão na interface <code>EqualsContract</code>, e a classe de teste simplesmente está fornecendo os valores que são utilizados nos testes (essencialmente, o exemplo acima é uma implementação com <a href="https://en.wikipedia.org/wiki/Template_method_pattern">template method</a>). Pra fins de simplicidade, o teste acima usa a classe String nos testes de igualdade, mas poderíamos usar a interface <code>EqualsContract</code> para testar a implementação do <code>equals</code> de qualquer outro objeto (bastaria criar outro teste alterando a assinatura: <code>implements EqualsContract&lt;QualquerTipo&gt;</code>).</p>
<p>Lembrando que nas versões anteriores do JUnit é possível implementar algo parecido usando herança (métodos de teste na superclasse, e testes específicos que extendem), porque os métodos de testes são <strong>herdados</strong>, o que continua ocorrendo no JUnit 5.</p>
<h2>Conclusão</h2>
<p>O JUnit 5 trouxe enormes mudanças em relação às versões anteriores, com novas funcionalidades excelentes e um inteligente modelo de extensão, que tornam ainda mais simples escrever testes de diversas formas para diferentes propósitos.</p>
<p>Nesse post, tentei abordar as principais novidades da nova versão. Talvez você tenha ficado com uma dúvida: &quot;mas e todos os testes que já existem no meu projeto, escritos no JUnit 3/4?&quot; Vamos falar disso no próximo post!</p>
<p>Obrigado e espero que tenha gostado! Em caso de dúvidas ou qualquer outra observação, sinta-se à vontade para usar a caixa de comentários!</p>

		<section class='share'>
			<a href='https://www.facebook.com/dialog/share?app_id=644444999041914&href=https://engenharia.elo7.com.br/amp/novidades-do-junit-5-parte-1/&display=popup' rel='noopener' target='_blank' class='link-share facebook' title='Clique para compartilhar no Facebook'>
				Compartilhar no facebook
			</a>
			<a href='https://twitter.com/intent/tweet?text=Novidades do JUnit 5 - parte 1&url=https://engenharia.elo7.com.br/amp/novidades-do-junit-5-parte-1/&hashtags=elo7tech' rel='noopener' target='_blank' class='link-share twitter' title='Clique para compartilhar no Twitter'>
				Compartilhar no twitter
			</a>
		</section>
	</div>
	<span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"> <!--Change for a post image-->
		<link href="/images/ico/elo7.png" itemprop="url"/>
		<meta itemprop='width' content='100px'/>
		<meta itemprop='height' content='100px'/>
	</span>

	<meta itemprop='headline' content='Recentemente (setembro/2017), foi lançado o JUnit 5, a nova versão do principal framework para testes de código na plataforma Java. Neste post, vamos conhecer algumas novidades e mudanças desse novo release.'/>
	<span itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
		<meta itemprop='name' content='Elo7 Tech'/>
		<meta itemprop="url" content='https://engenharia.elo7.com.br'/>
		<span itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
			<link href="https://images.elo7.com.br/assets/v3/desktop/png/logo-elo7.png" itemprop="url"/>
			<meta itemprop='width' content='100px'/>
			<meta itemprop='height' content='100px'/>
		</span>
	</span>
	<meta itemprop='mainEntityOfPage' content='Elo7 Serviços de Informática SA'/>
</article>
	</main>
	<footer itemscope itemtype='http://schema.org/Organization'>
		<a rel='home' itemprop='url' href='/amp/home/'>engenharia.elo7.com.br © 2017</a>
		<meta itemprop='name' content='Elo7 Serviços de Informática SA'/>
		<section class='footer-social'>
			<a title='Github do Elo7' rel='external' itemprop='url' href='https://github.com/elo7' target='_blank' class='github'>Github do Elo7</a>
			<a title='Twitter do Elo7' rel='external' itemprop='url' href='https://twitter.com/elo7tech' target='_blank' class='twitter'>Twitter do Elo7</a>
			<a title='RSS do Elo7' rel='external' itemprop='url' href='https://engenharia.elo7.com.br/rss.xml' target='_blank' class='rss'>RSS do Elo7</a>
			<a title='Newsletter do Elo7' rel='external' itemprop='url' href='http://eepurl.com/cVUwvH' target='_blank' class='email'>Newsletter do Elo7</a>
		</section>
	</footer>
	<amp-analytics type='googleanalytics'>
		<script type='application/json'>
			{
				"vars": {
					"account": "UA-3692628-29"
				},
				"triggers": {
					"trackPageview": {
						"on": "visible",
						"request": "pageview"
					}
				}
			}
		</script>
	</amp-analytics>
</body>
</html>
